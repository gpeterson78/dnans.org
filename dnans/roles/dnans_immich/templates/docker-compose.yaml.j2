version: '3.9'

services:
  immich-server:
    image: ghcr.io/immich-app/immich-server:${IMMICH_VERSION}
    container_name: immich-server
    restart: unless-stopped
    env_file:
      - .env
    volumes:
      - ${IMMICH_SERVER_PATH}:/app/data
    networks:
      - ${DOCKER_NETWORK_NAME}

  immich-microservices:
    image: ghcr.io/immich-app/immich-microservices:${IMMICH_VERSION}
    container_name: immich-microservices
    restart: unless-stopped
    env_file:
      - .env
    networks:
      - ${DOCKER_NETWORK_NAME}

  immich-redis:
    image: redis:alpine
    container_name: immich-redis
    restart: unless-stopped
    env_file:
      - .env
    networks:
      - ${DOCKER_NETWORK_NAME}

  immich-db:
    image: postgres:14
    container_name: immich-db
    restart: unless-stopped
    env_file:
      - .env
    volumes:
      - ${IMMICH_DB_PATH}:/var/lib/postgresql/data
    networks:
      - ${DOCKER_NETWORK_NAME}

networks:
  ${DOCKER_NETWORK_NAME}:
    external: true
